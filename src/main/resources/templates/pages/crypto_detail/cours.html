<!DOCTYPE html>
<html lang="fr" th:replace="~{_layout :: layout(~{::title}, ~{::body})}" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Courbe de fluctuation du crypto</title>
</head>
<body class="bg-gray-900 text-white">

<div class="container mx-auto p-4">
    <h1 class="text-4xl font-bold text-transparent bg-gradient-to-r from-cyan-500 to-blue-500 bg-clip-text mb-8">
        Courbe de fluctuation du crypto
    </h1>

    <form method="get" th:action="@{/cours/chart/traitement/}" class="mb-6">
        <div class="form-group">
            <label for="crypto" class="block text-gray-400 mb-2">Crypto-monnaie</label>
            <select id="crypto" name="crypto" class="w-full max-w-xs p-3 bg-gray-800 border border-gray-600 rounded-md text-white">
                <option th:each="c : ${cryptomonnaies}" th:value="${c.id}" th:text="${c.designation}"></option>
            </select>
        </div>
        <button type="submit" class="mt-4 px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-md hover:opacity-90 transition">
            Rechercher
        </button>
    </form>

    <div class="bg-gradient-to-br from-gray-700 to-gray-800 p-6 rounded-lg shadow-lg mb-8">
        <div id="cryptoChart"></div>
    </div>
</div>

<script th:inline="javascript">
    /*<![CDATA[*/
    const chartData = /*[[${coursCryptoos}]]*/ '[]';

    const options = {
        chart: {
            type: 'line',
            height: 350
        },
        series: [{
            name: 'Prix en EUR',
            data: chartData.map(data => data.coursActuel)
        }],
        xaxis: {
            categories: chartData.map(data => data.dateCours),
            labels: {
                style: {
                    colors: '#a0aec0'
                }
            },
            axisBorder: {
                color: 'rgba(255, 255, 255, 0.1)'
            }
        },
        yaxis: {
            labels: {
                style: {
                    colors: '#a0aec0'
                }
            },
            axisBorder: {
                color: 'rgba(255, 255, 255, 0.1)'
            }
        },
        stroke: {
            curve: 'smooth',
            width: 2
        },
        fill: {
            opacity: 0.1
        },
        grid: {
            borderColor: 'rgba(255, 255, 255, 0.1)'
        },
        tooltip: {
            theme: 'dark'
        }
    };

    var chart = new ApexCharts(document.querySelector("#cryptoChart"), options);
    chart.render();
    /*]]>*/
</script>

</body>
</html>
